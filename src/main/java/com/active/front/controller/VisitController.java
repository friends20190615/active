package com.active.front.controller;import com.active.bean.VisitInfo;import com.active.front.service.VisitService;import com.alibaba.fastjson.JSONObject;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import javax.servlet.http.HttpServletRequest;import java.util.List;/** * 参观报名controller * * @author ta * @date 2019/6/30 下午8:42 * @since 1.0 */@Controller@RequestMapping("/visit")public class VisitController {    private final static Logger logger = LoggerFactory.getLogger(VisitController.class);    @Autowired    private VisitService visitService;    @RequestMapping("newMember")    @ResponseBody    public String pullNewMember(VisitInfo visitInfo,HttpServletRequest request){        JSONObject res = new JSONObject();        res.put("code", 0);        res.put("msg", "success");        try {            VisitInfo exit =visitService.getVisitInfo(visitInfo);            if(exit ==null){                visitService.insertInfo(visitInfo);            }else{                //已经存在                res.put("code", 5);                res.put("msg", "success");            }        }catch (Exception e){            logger.error("error："+e.getMessage());            res.put("code", -1);            res.put("msg", "error");        }        return res.toJSONString();    }    @RequestMapping("getList")    @ResponseBody    public String getList(VisitInfo visitInfo,HttpServletRequest request){        JSONObject res = new JSONObject();        res.put("code", 0);        res.put("msg", "success");        try {            visitInfo.setPageSize((visitInfo.getPage()-1)*visitInfo.getLimit());            List<VisitInfo> vis =visitService.getVisitInfos(visitInfo);            Integer count = visitService.getCount(visitInfo);            res.put("data",vis);            res.put("count",count);        }catch (Exception e){            logger.error("error："+e.getMessage());            res.put("code", -1);            res.put("msg", "error");        }        return res.toJSONString();    }}